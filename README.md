# キャリフレ (Career Fre)

自己理解の旅を支援する内省支援プラットフォーム

## 概要

キャリフレは、診断・記録・内省・行動計画のツールを通じて、ユーザーの「今」を可視化し、「これから」を具体化する自己理解プラットフォームです。転職する／続ける／働き方を変える——まずは自分を理解することから始めましょう。

### 主な特徴

- **自分で気づくツール**: 答えを与えるのではなく、あなたの中の答えを見えるようにする
- **データとして蓄積・可視化**: レーダーチャートやタイムラインで、いつでも振り返ることができる
- **AIによる内省支援**: AWS Bedrock（Claude）を活用した自然な内省チャットとフィードバック
- **継続的な成長の可視化**: 持ち味レポで変化や成長を実感できる

### ターゲットユーザー

- キャリアの方向性に悩んでいる方
- 自分自身をより深く理解したい方
- 日々の内省を習慣化したい方
- 行動計画を立てて実行したい方

## 主な機能

### 診断・分析

#### 現職満足度診断

- **6つの領域での診断**: Purpose（目的・意義）、Life（生活）、Privilege（特権・待遇）、Position（地位・立場）、People（人間関係）、Performance（成果・パフォーマンス）
- **満足度と重要度の比較**: 各領域について満足度と重要度を診断し、差分を可視化
- **レーダーチャート可視化**: 診断結果をレーダーチャートで可視化し、バランスを一目で把握
- **動的コメント生成**: 満足度と重要度の差分に基づいて、以下を自動抽出
  - **01 フォーカス領域**: 満足度が重要度より低い領域（改善の余地がある領域）
  - **02 活かしたい強み**: 満足度が重要度より高い領域（既に満たしている強み）
  - **03 総評**: 01と02の組み合わせに基づく総合的なコメント（25パターンの事前準備コメント）
- **「すべて良好」ケースの処理**: すべての領域で満足度が重要度以上の場合、「すべて良好」メッセージを表示
- **未計測ケースの処理**: 重要度が未回答の場合は「未計測」、すべての領域で満足度=重要度の場合は最小満足度を選択
- **スコア計算**: 重み付け平均による正確なスコア計算（0-100点）
- **重要度の後から設定**: 診断完了後でも重要度を設定可能

#### 自己診断結果

- **複数の診断タイプに対応**:
  - MBTI（16タイプ）
  - ストレングスファインダー（34の強み）
  - エニアグラム（9つのタイプ）
  - ビッグファイブ（5因子）
  - FFS理論（5つの特性：凝縮性・受容性・弁別性・拡散性・保全性）
  - カスタム診断
- **診断結果の記録と管理**: 複数の診断結果を時系列で記録・比較
- **可視化**: 複数の診断結果をレーダーチャートで比較表示

### 記録・振り返り

#### 日記

- **モチベーションバー**: 毎日のモチベーションを0-100で記録
- **写真付きカレンダー**: 日々の出来事を写真とともに記録
- **カレンダービュー**: 月次カレンダーで過去の記録を振り返り
- **AI内省チャット**: 構造化された内省フローで深い振り返りを支援
  - **メッセンジャー風UI**: ユーザーメッセージの即時反映、タイピングインジケーター
  - **トピック選択**: 仕事、家族、健康、趣味などのトピックから選択
  - **構造化された質問フロー**: 事実の確認 → 印象・感情の深掘り → フィードバック
  - **会話履歴の保存**: 内省チャットの会話を保存し、後から振り返り可能
  - **日記への自動保存**: 内省チャットの内容を日記として自動保存
- **目標・目的との接続**: 日記内容をマイルストーンやWCMシートのWillと自動接続（接続度0-100で表示）
- **AIフィードバック**: 日記内容に対するAIからの内省フィードバック
- **アクション提案**: 日記から具体的なアクションアイテムを自動提案

#### 人生史

- **タイムライン表示**: 人生のターニングポイントを時系列で可視化
- **価値観の抽出**: 過去の出来事から価値観のルーツを発見
- **モチベーショングラフ**: 人生の浮き沈みをグラフで可視化

#### マイルストーン

- **目標管理**: キャリアや人生のマイルストーンを設定・管理
- **アクションアイテム**: 各マイルストーンに関連する具体的なアクションを管理
  - アクションアイテムの削除・移動機能
  - AIによるアクションプラン提案（優先度順、最大5個）
- **進捗追跡**: マイルストーンの達成状況を追跡
- **Willテーマ**: 各マイルストーンにWillテーマを設定

### 行動計画

#### WCMシート

- **Will（こう在りたい）**: 理想のあり方を言語化
- **Can（できること）**: 現在の能力・強みを整理
- **Must（やるべきこと）**: 現実的に取り組むべきことを明確化
- **AI自動生成機能**: 診断結果や日記内容からAIが自動生成
  - 直近1ヶ月の日記、診断結果、自己診断、マイルストーン、人生史を分析
  - Will/Can/Mustそれぞれを個別に5項目ずつ生成
  - 生成後は手書きで編集可能
- **90日アクションプラン**: 具体的な行動計画を立てる

#### マイルストーン

- **目標設定**: 短期・中期・長期の目標を設定
- **アクション管理**: 目標達成のための具体的なアクションを管理
- **進捗可視化**: 目標とアクションの進捗を可視化

### 持ち味レポ

#### 持ち味レポ（プチ取説）

- **持ち味3つの生成**: 診断結果と日記（7日間）から自動生成される持ち味3つ
- **変化要素3つ**: 2回目以降のレポ生成時に、前回のレポ（n回目）と今回のデータ（n+1回目）を比較して生成
  - データ変化がある場合: 持ち味の変化、マイルストーン完了、感情の変化、話題の変化、行動の変化など
  - データ変化がない場合: 「変化が少ない期間でした」というメッセージと、継続的な入力を励ますメッセージ
- **データ変化の検証**: 前回のレポ生成以降に新しい診断、日記、マイルストーン完了があるかチェック
- **更新制限**: 1ヶ月に1回のみ更新可能（開発環境では1日経過で更新可能）
- **生成条件**: 7日間の日記記録が必要
- **PDFダウンロード機能**: 持ち味レポをPDFとしてダウンロード可能
- **SNSシェア最適化デザイン**: 
  - グラデーションカード（ブルー、パープル、グリーン、オレンジ）
  - キャリくまのアイコン
  - メッセンジャー風の洗練されたデザイン
  - スクリーンショット時に美しく見えるレイアウト

#### コンテキスト別持ち味レポ

- **コンテキスト検出**: 日記の内容から「仕事」「家族」「趣味」などのコンテキストを自動検出
- **コンテキスト別の持ち味生成**: 各コンテキストに応じた持ち味レポを生成
- **複数コンテキストの管理**: 複数のコンテキスト別レポを一覧で管理

### 相談・サポート

- **面談申し込み**: キャリアアドバイザーとの1on1セッションを予約（外部リンク）
- **LINE登録**: LINEでの相談対応（外部リンク）
- **トップページの相談案内**: ログイン前のトップページに控えめな相談案内を表示

### その他機能

#### ゴールイメージ

- **言語化機能**: 3-4行程度の簡潔なゴールイメージを保存・表示
- **表示モード**: テキスト/図式（nanobanana pro API）の表示モード切り替え
- **常時表示**: 日記作成画面・マイルストーン設定画面に常時表示
- **未来と価値観のバランス**: 未来に7割、価値観などに3割の割合で表示

#### 目標・目的との接続

- **自動接続検出**: 日記内容をマイルストーンやWCMシートのWillテーマと自動的に接続
- **接続度の表示**: 接続度（0-100）と接続理由を表示
- **可視化**: 日記保存時に自動的に接続情報を表示

#### ダッシュボード

- **最新情報の一覧表示**:
  - 最新の診断結果
  - 今日の日記
  - 最新のマイルストーン
  - 過去の自分を思い出す（スライド形式のカルーセル）
- **クイックアクセス**: 各機能への直接リンク
- **内省ストリーク**: 連続記録日数の表示
- **今月・今週の内省回数**: 統計情報の表示

#### オンボーディング進捗管理

- **ステップ管理**: 診断完了、7日間日記記録、持ち味レポ生成などの進捗を管理
- **進捗バー**: オンボーディングの進捗を可視化

#### マッピング機能

- **自己理解の進捗可視化**: 人生史、日記、持ち味レポ、WCMシート、マイルストーン、マイゴールの完了状況を可視化
- **次に取り組むべき項目の提案**: 未完了項目を優先順位付きで表示

## 技術スタック

### バックエンド

- **Laravel 12**: PHPフレームワーク
- **PHP 8.2+**: プログラミング言語
- **Livewire 3**: リアクティブなUIコンポーネント
- **Laravel Fortify**: 認証機能
- **Eloquent ORM**: データベース操作

### フロントエンド

- **Livewire Flux 2.1+**: UIコンポーネントライブラリ
- **Alpine.js**: クライアントサイドのインタラクティブ機能
- **Tailwind CSS 4**: ユーティリティファーストのCSSフレームワーク
- **Vite 7**: ビルドツール
- **Chart.js**: データ可視化（レーダーチャート）

### AI・機械学習

- **AWS Bedrock**: Claude AIモデル（Claude 3 Sonnet）による自然言語処理
  - 内省チャット
  - 日記フィードバック生成
  - WCMシート自動生成
  - アクションプラン提案
  - 目標・目的との接続判定
  - 持ち味レポ生成（持ち味3つ、変化要素3つ）
  - コンテキスト別持ち味レポ生成
  - タイムアウト設定: 120秒（HTTPタイムアウト、接続タイムアウト10秒）

### その他

- **AWS SDK 3.300+**: クラウドストレージ連携
- **DomPDF 3.1+**: PDF生成（持ち味レポのPDFダウンロード）
- **SQLite/MySQL**: データベース
- **nanobanana pro API**: ゴールイメージの図式化

## セットアップ

### 必要な環境

- PHP 8.2以上
- Composer
- Node.js 18以上
- npm または yarn

### インストール手順

1. **リポジトリのクローン**
```bash
git clone https://github.com/kayoajiki/carefle.git
cd carefle
```

2. **依存関係のインストール**
```bash
composer install
npm install
```

3. **環境設定**
```bash
cp .env.example .env
php artisan key:generate
```

4. **データベース設定**
`.env`ファイルでデータベース接続情報を設定

5. **AWS Bedrock設定**
`.env`ファイルに以下の設定を追加：
```
AWS_BEDROCK_REGION=us-east-1
AWS_ACCESS_KEY_ID=your_access_key
AWS_SECRET_ACCESS_KEY=your_secret_key
AWS_BEDROCK_MODEL_ID=anthropic.claude-3-sonnet-20240229-v1:0
AWS_BEDROCK_MAX_TOKENS=4096
AWS_BEDROCK_TEMPERATURE=0.7
AWS_BEDROCK_TOP_P=0.9
```

6. **マイグレーション実行**
```bash
php artisan migrate
```

7. **アセットのビルド**
```bash
npm run build
```

8. **開発サーバー起動**
```bash
php artisan serve
npm run dev
```

または、Composerスクリプトを使用：
```bash
composer run dev
```

### 開発環境でのテスト

持ち味レポの更新制限は、開発環境（`APP_ENV=local`）では1日経過で更新可能になります。本番環境では1ヶ月の制限が維持されます。

## プロジェクト構造

```
carefle/
├── app/
│   ├── Http/Controllers/          # コントローラー
│   │   ├── Admin/                 # 管理画面コントローラー
│   │   ├── DiagnosisController.php
│   │   ├── OnboardingController.php
│   │   ├── ManualController.php
│   │   └── ...
│   ├── Livewire/                  # Livewireコンポーネント
│   │   ├── DiaryChatForm.php      # 内省チャット
│   │   ├── DiaryForm.php          # 日記フォーム
│   │   ├── DiagnosisForm.php      # 診断フォーム
│   │   ├── WcmForm.php            # WCMシートフォーム
│   │   └── ...
│   ├── Models/                    # Eloquentモデル
│   │   ├── StrengthsReport.php    # 持ち味レポ
│   │   ├── Diary.php
│   │   ├── Diagnosis.php
│   │   └── ...
│   ├── Services/                  # ビジネスロジック
│   │   ├── MiniManualGeneratorService.php      # 持ち味レポ生成
│   │   ├── ContextualManualGeneratorService.php # コンテキスト別持ち味レポ
│   │   ├── ReflectionChatService.php           # 内省チャット
│   │   ├── BedrockService.php                 # AWS Bedrock連携
│   │   ├── DiaryAnalysisService.php           # 日記分析
│   │   ├── DiagnosisIntegrationService.php    # 診断統合分析
│   │   ├── GoalConnectionService.php         # 目標・目的との接続
│   │   └── ...
│   └── ...
├── database/
│   ├── migrations/               # データベースマイグレーション
│   └── seeders/                   # シーダー
├── resources/
│   ├── views/                    # Bladeテンプレート
│   │   ├── onboarding/
│   │   │   └── mini-manual.blade.php  # 持ち味レポ表示
│   │   ├── manual/               # コンテキスト別持ち味レポ
│   │   ├── livewire/             # Livewireコンポーネントのビュー
│   │   └── ...
│   ├── css/
│   │   └── app.css              # メインCSS（Tailwind + カスタムスタイル）
│   └── js/
│       └── app.js                # メインJavaScript
├── routes/
│   └── web.php                   # ルート定義
└── ...
```

## 主要なルート

### 認証不要

- `/` - トップページ（相談案内含む）

### 認証必要

#### 診断・分析
- `/diagnosis/start` - 現職満足度診断開始
- `/diagnosis/result/{id}` - 診断結果表示（総評カード、フォーカス領域、活かしたい強み）
- `/diagnosis/importance/{id}` - 重要度設定
- `/assessments` - 自己診断結果一覧
- `/assessments/visualization` - 自己診断結果可視化

#### 記録・振り返り
- `/diary` - 日記（カレンダービュー）
- `/diary/chat` - AI内省チャット
- `/life-history` - 人生史入力
- `/life-history/timeline` - 人生史タイムライン
- `/career/milestones` - マイルストーン管理
- `/career/timeline` - キャリアタイムライン

#### 行動計画
- `/wcm/start` - WCMシート作成（質問形式）
- `/wcm/sheet/{id}` - WCMシート表示・編集（AI自動生成機能付き）
- `/my-goal` - マイゴール（ゴールイメージ）

#### 持ち味レポ
- `/onboarding/mini-manual` - 持ち味レポ表示
- `/onboarding/mini-manual/update` - 持ち味レポ更新（POST）
- `/onboarding/mini-manual/pdf` - 持ち味レポPDFダウンロード
- `/manual` - コンテキスト別持ち味レポ一覧
- `/manual/context/{context}` - コンテキスト別持ち味レポ表示

#### その他
- `/dashboard` - ダッシュボード
- `/mapping` - マッピング（自己理解の進捗可視化）
- `/profile/setup` - プロフィール設定
- `/settings/profile` - プロフィール編集
- `/settings/password` - パスワード変更
- `/settings/appearance` - 外観設定

#### 相談・サポート（外部リンク）
- 面談申し込み: https://careerpartner.jp/carehugforI
- LINE登録: https://line.me/R/ti/p/@824flemq

## 主要な機能の詳細説明

### 持ち味レポ機能

#### 生成条件

- **7日間の日記記録**: 持ち味レポを生成するには、7日間の日記記録が必要
- **診断結果**: 現職満足度診断または自己診断結果のいずれかが必要

#### 更新制限

- **本番環境**: 1ヶ月に1回のみ更新可能
- **開発環境**: 1日経過で更新可能（`APP_ENV=local`の場合）

#### 変化要素の生成ロジック

1. **データ変化の検証**: 前回のレポ生成以降に新しい診断、日記、マイルストーン完了があるかチェック
2. **変化がある場合**: 前回のレポ（n回目）と今回のデータ（n+1回目）を比較して、変化要素3つを生成
3. **変化がない場合**: 「変化が少ない期間でした」というメッセージを1つ生成し、継続的な入力を励ます

#### デザイン特徴

- **グラデーションカード**: 各持ち味カードに異なるグラデーション（ブルー、パープル、グリーン）
- **キャリくまアイコン**: 番号の代わりにキャリくまのアイコンを使用
- **変化要素**: オレンジ系のグラデーションで区別
- **SNSシェア最適化**: スクリーンショット時に美しく見えるレイアウト

### 内省チャット機能

#### メッセンジャー風UI

- **ユーザーメッセージの即時反映**: 送信ボタンを押すと即座にメッセージが表示
- **タイピングインジケーター**: AIが応答を生成している間、3つの●が順番に跳ねるアニメーションを表示
- **ユーザーアバター**: ユーザー名の最初の1文字を表示（日本語対応）

#### デバイス別の動作

- **モバイル・iPad**: 改行ボタンは改行のみ、送信は紙飛行機ボタンのみ
- **PC**: Enterキーで送信、Shift+Enterで改行

#### トピック選択

- 仕事、家族、健康、趣味などのトピックから選択可能
- 選択したトピックに応じた構造化された質問フロー

### 診断結果機能

#### 総評カード（03 総評）

- **01 フォーカス領域**と**02 活かしたい強み**の組み合わせに基づく総合的なコメント
- **25パターンの事前準備コメント**: すべての組み合わせに対応
- **診断未完了時**: 「診断を受けると表示されます」というメッセージを表示

#### 「すべて良好」ケース

- すべての領域で満足度が重要度以上の場合、「すべて良好」メッセージを表示
- 01、02、03すべてで「すべて良好」を表示

#### 未計測ケースの処理

- **重要度未回答**: 「未計測」のまま表示
- **すべての領域で満足度=重要度**: 最小満足度の領域をフォーカス領域として選択

## 開発環境でのテスト方法

### 持ち味レポの更新制限をテストする場合

開発環境では、`app/Models/StrengthsReport.php`の`canUpdate()`メソッドにより、1日経過で更新可能になります。

データベースで直接日付を変更する場合：
```bash
php artisan tinker
>>> $report = \App\Models\StrengthsReport::getLatestForUser(1);
>>> $report->generated_at = now()->subDays(2);
>>> $report->save();
```

## ライセンス

このプロジェクトはMITライセンスの下で公開されています。

## 開発者

- [GitHub](https://github.com/kayoajiki/carefle)

## 謝辞

キャリフレは、自己理解を通じてキャリアの選択肢を広げることを目的としたサービスです。日常的な自己理解の習慣が、あなたを変えます。
